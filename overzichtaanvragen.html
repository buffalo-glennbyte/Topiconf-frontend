<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="overzichtStyle.css">
    <script>
        

       
        function handleRequest(option ,id){
            document.querySelector(`#request${id}`).classList.add(option); 
            console.log(document.querySelector(`#request${id}`));
        }

        function clear(){
            //clear the data 
            document.querySelector(".requestList").innerHTML='';
        }

        function refresh(){
            clear();
            toonAanvragen();
        }
        
        function toonAanvragen(){
          
            var xhr = new XMLHttpRequest();
            const wrapper = document.querySelector(".requestList");
            xhr.open("GET", "http://localhost:8082/getBody", true);
            xhr.send();

           xhr.addEventListener("load", function(){
                const data = JSON.parse(this.responseText);
                console.log(data);
                for(let x = 0; x < data.length; x++){
                    const html =`
                <div class="request" id='request${data[x].id}'>
                     <div class="data name"><p>Naam: ${data[x].naam}</p></div>
                     <div class="data surname"><p>Voornaam: ${data[x].voornaam}</p></div>
                     <div class="data topic"><p>onderwerp: ${data[x].onderwerp}</p></div>
                     <div class="data email"><p>eMail: <a href="mailto:${data[x].eMail}">${data[x].eMail}</a></p></div>
                     <div class="buttons">
                     <div class="actionBtn green" onclick='handleRequest("accept",${data[0].id})'></div>
                     <div class="actionBtn yellow" onclick='handleRequest("flag",${data[0].id})'></div>
                      <div class="actionBtn delete" onclick='handleRequest("reject",${data[0].id})'></div>
                  </div>
                 </div>`;
                 console.log(wrapper);
                 wrapper.insertAdjacentHTML("beforeend",html);
                }
                
                })
                
            
            // const data= fetch("http://localhost:8082/getBody").then((data)=>data.json()).then((respond)=>{return respond });

            // console.log(data);
            // const[xyz] = data.catch(any)
            // console.log(xyz[0]);
            }
           
            
        
    </script>
</head>
<body onload="toonAanvragen()">
    
   <div class="wrapper">
   <button onclick = "refresh()" class="btn">vernieuwen</button>
   <div class="requestList"></div>
   </div>
</body>
</html>