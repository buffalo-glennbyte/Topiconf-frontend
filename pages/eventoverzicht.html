<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TC - Event overzicht</title>
    <link rel="stylesheet" href="../styles/style.css">
    <style>
        
        body {
            display: flex;
            flex-direction: column;

        }

        .leftside {
            width: 50%;
            height: fit-content;
        }

        .rightside {
            width: 50%;
            height: fit-content;
            background-color: lightslategray;
        }

        td {
            padding-left: 10px;
            padding-right: 10px;
        }
    </style>


    <script>
        function toonEvenementen(){
            var xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function(){
                if(this.readyState == 4){
                    console.log("Evenementen opgehaald");
                    var allEvents = JSON.parse(this.responseText);
                    var eindString = "<table border=2><tr><th>Titel</th><th>Omschrijving</th><th>Begin</th><th>Eind</th>";
                        for(var x = 0; x < allEvents.length; x++){
                            eindString += "<tr><td>" + allEvents[x].naam + "</td>";
                            eindString += "<td>" + allEvents[x].omschrijving + "</td>";
                            eindString += "<td>" + allEvents[x].beginDatumTijd + "</td>";
                            eindString += "<td>" + allEvents[x].eindDatumTijd + "</td>";
                            eindString += "<td><button onclick='toonTracksPerEvenement(" + allEvents[x].id + ")'>Show tracks</button></td>"
                            eindString += "<td><button onclick='bekijkAanvragen("+ allEvents[x].id +")'>Aanvragen</button></td>" 
                            eindString += "<td><button onclick='deleteEvent("+allEvents[x].id+")'>Delete</button></td></tr>";
                        }
                    eindString += "</table>";
                    document.getElementById("alleEvenementenTabel").innerHTML = eindString;
                }
            }
            xhr.open("GET","http://localhost:8082/evenement/alleEvenementen", true);
            xhr.send();
        }

        function toonTracksPerEvenement(id, name){
            var xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function(){
                if(this.readyState == 4){
                    console.log(this.responseText);
                    var allTracksPerEvent = JSON.parse(this.responseText);
                    var HTMLString = "<p>Tracks voor " + name + "</p>";
                    HTMLString += "<table border=1>";
                    HTMLString += "<tr><td>Naam</td> <td>Omschrijving</td></tr>"
                    for(var i = 0; i < allTracksPerEvent.length; i++){
                        HTMLString += "<td>" + allTracksPerEvent[i].name + "</td>";
                        HTMLString += "<td>" + allTracksPerEvent[i].description + "</td>";
                        HTMLString += "<td><button onclick='verwijderTrack("+allTracksPerEvent[i].id+")'>Delete</button></td><tr>"
                    }                   
                    HTMLString += "</table>";
                    document.getElementById("trackTable").innerHTML = HTMLString;                  
                }
            }
            xhr.open("GET","http://localhost:8082/evenement/geefAlleTracksPerEvenement/" + id, true);
            xhr.send();
            document.getElementById("")
        }

        function voegTrackToeAanEvent(id){
            var xhr = new XMLHttpRequest();
            var trackToAdd = {};
            trackToAdd.name = document.getElementById("trackNaam").value;
            trackToAdd.description = document.getElementById("trackDescription").value;

                
            xhr.open("POST", "http//localhost:8082/track/voegTrackToeAanEvenement/" + id);
            xhr.send();
        }

        function verwijderTrack(id){
            var xhr = new XMLHttpRequest();


            xhr.open("DELETE", "http://localhost:8082/track/verwijderTrack/" + id, true);
            xhr.send();
        }

        function deleteEvent(EVENTID){

        }

        function bekijkAanvragen(EVENTID)
        {
            var xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function()
            {
                if(this.readyState == 4)
                {
                    console.log("Redirect to event ID: " + EVENTID);
                }
            }

            xhr.open("GET", "http://localhost:8082/evenement/alleEvenementen/" +EVENTID, true);
            xhr.send();
        }



        function deleteEvent(EVENTID)
        {
            var xhr = new XMLHttpRequest();
            xhr.onreadystatechange = function(){
                if(this.readyState == 4){
                    console.log("Event verwijderd");
                }
            }
            xhr.open("DELETE","http://localhost:8082/evenement/verwijderEvent/" + EVENTID, true);
            xhr.send();
        }
    </script>
</head>


<body onload="toonEvenementen()">
    <header>
        <h1 class="title">Evenementen</h1>
        <nav>
            <ul>
                <li><a href="eventoverzicht.html">Evenementen</a></li>
                <li><a href="trackoverzicht.html">Tracks</a></li>
                <li><a href="locatieoverzicht.html">Locaties</a></li>
                <li><a href="overzichtaanvragen.html">Aanvragen</a></li>
                <li><a class="active" href="planner.html">Planner</a></li>
              </ul>
        </nav>
    </header>
    <main>
        <div class="leftside">
            <button onclick="toonEvenementen()">Ververs evenementen</button>
            <div id="alleEvenementenTabel"></div>
        </div>
        <div class="rightside">
            <div id="trackTable">
            </div>
        </div>
    </main>
 
</body>
</html>