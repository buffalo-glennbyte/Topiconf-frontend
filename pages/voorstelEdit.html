<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mijn Voorstel Edit</title>
    <link rel="stylesheet" href="../styles/header.css">
    <link rel="stylesheet" href="../styles/style.css">

    <style>
        .is-flex{
            display: flex;
            align-items: center;
            justify-content: space-evenly;
        }
    .grid-container {
      display: grid;
      grid-template-columns: auto auto auto;
      width: 80%;
      margin-left: auto;
      margin-right: auto;
      gap: 10px;
      padding: 10px;
    }
    
    .grid-container > div {
      background-color: rgba(255, 255, 255, 0.8);
    }

    table, th, td {
        border: none;
    }

    td {
        display: flex;
        flex-direction: row;
    }

    label {
        width: 130px;
    }
    </style>

    <script>
        let huidigVoorstelId;
        window.onload = function(){
            huidigVoorstelId = window.location.href.split("=").pop();
            
            document.getElementById("updateButton").innerHTML = `<button onclick="updateVoorstel(${huidigVoorstelId})">Update voorstel</button>`;
            laadGeselecteerdVoorstel(huidigVoorstelId);
            laadBenodigdheden();            
        }
        
        const laadBenodigdheden = function(){
            HTMLString = "";
            fetch(`http://localhost:8082/benodigdheid/geefAlleBenodigdheden`)
                .then((request)=> request.text())
                .then((data)=> alleBenodigdheden = JSON.parse(data))
                .then((alleBenodigdheden)=> {
                    HTMLString += "<h4>Benodigdheden</h4>"
                    HTMLString += "<select>"
                    alleBenodigdheden.forEach((benodigdheid)=> {
                        HTMLString += `<option name="benodigdhedenSelector" value=${benodigdheid.id}>${benodigdheid.name}</option>`
                    })
                    HTMLString += "</select>"
                })
                .then(()=> {
                    document.getElementById("benodigdhedenDiv").innerHTML = HTMLString
                })
        }

        const laadGeselecteerdVoorstel = function(voorstelid){
            fetch(`http://localhost:8082/voorstel/geefVoorstelPerId/${huidigVoorstelId}`)
                .then((request)=> request.text())
                .then((data)=> geselecteerdVoorstel = JSON.parse(data))
                .then((geselecteerdVoorstel)=>{
                    console.log(geselecteerdVoorstel);
                    document.getElementById("voornaamInput").value = geselecteerdVoorstel.voornaam;
                    document.getElementById("achternaamInput").value = geselecteerdVoorstel.achternaam;
                    document.getElementById("emailInput").value = geselecteerdVoorstel.eMail;
                    document.getElementById("onderwerpInput").value = geselecteerdVoorstel.onderwerp;
                    document.getElementById("samenvattingInput").value = geselecteerdVoorstel.samenvatting;
                    document.getElementById("tijdsduurInput").value = geselecteerdVoorstel.tijdsduur;
                    document.getElementById("capaciteitInput").value = geselecteerdVoorstel.maxCapaciteit;
                })
        }

        const updateVoorstel = function(voorstelid){
            let geupdatetVoorstel = {};
            geupdatetVoorstel.voornaam = document.getElementById("voornaamInput").value;
            geupdatetVoorstel.achternaam = document.getElementById("achternaamInput").value;
            geupdatetVoorstel.eMail = document.getElementById("emailInput").value;
            geupdatetVoorstel.onderwerp = document.getElementById("onderwerpInput").value;
            geupdatetVoorstel.samenvatting = document.getElementById("samenvattingInput").value;
            geupdatetVoorstel.tijdsduur = document.getElementById("tijdsduurInput").value;
            geupdatetVoorstel.maxCapaciteit = document.getElementById("capaciteitInput").value;
            geupdatetVoorstel.id = voorstelid;
            geupdatetVoorstel.benodigdhedenLijst = [];
            
            fetch(`http://localhost:8082/voorstel/updateVoorstel`, {
                method: "PUT", 
                headers: {
                    "Content-Type" : "application/json"
                },
                body: JSON.stringify(geupdatetVoorstel)
            })
            .then(()=> laadGeselecteerdVoorstel(39))
        }
    </script>

</head>
<body>

    <header class="hdr-main">
        <img src="../images/TopicusLogo.png" class="hdr-img">
        <div class="hdr-btns">
            <p class="hdr-btns-text">Je bent ingelogd als: XYZ</p>
            <button class="hdr-btns-btn" >Profiel</button>
            <button class="hdr-btns-btn">Uitloggen</button>
        </div>
    </header>


    <div class="grid-container">
        <div>
            <table>
                <tr>
                    <td>
                        <h3>Sprekers</h3>
                        <p></p>
                    </td>
                </tr>
                <tr>
                    <td>
                        <label for="Voornaam">Voornaam: </label>
                        <input type="text" id="voornaamInput" placeholder="John">
                    </td>
                </tr>
                <tr>
                    <td>
                        <label for="Achternaam">Achternaam:</label>
                        <input type="text" id="achternaamInput" placeholder="Marston">
                    </td>
                </tr>
                <tr>
                    <td>
                        <label for="Email">Email:</label>
                        <input type="text" id="emailInput" placeholder="John@email.com">
                    </td>
                </tr>
            </table>
        </div>

        <div>
            <table>
                <tr>
                    <td>
                        <h3>Presentatie</h3>
                        <p></p>
                    </td>
                </tr>
                <tr>
                    <td>
                        <label for="Onderwerp">Onderwerp: </label>
                        <input type="text" id="onderwerpInput" placeholder="Oreren over techniek">
                    </td>
                </tr>
                <tr>
                    <td>
                        <label for="samenvatting">Korte samenvatting:</label>
                        <input type="text" id="samenvattingInput" placeholder="Techniek in de brede zin van het woord bekeken  ..................">
                    </td>
                </tr>
            </table>
        </div>

        <div>
            <table>
                <tr>
                    <td>
                        <h3>Status</h3>
                        <p></p>
                    </td>
                </tr>
                <tr>
                    <td>
                        <div style="background-color: aquamarine;">
                            Geaccepteerd
                        </div>
                        <div>

                        </div>
                    </td>
                </tr>
            </table>
        </div> 

        <div>
            <table>
                <tr>
                    <td>
                        <h4>Voeg spreker toe</h4>
                        <p></p>
                    </td>
                </tr>
                <tr>
                    <td>
                        <label for="Naam">Voornaam: </label>
                        <input type="text" placeholder="John">
                    </td>
                </tr>
                <tr>
                    <td>
                        <label for="Achternaam">Achternaam</label>
                        <input type="text" placeholder="Vogel">
                    </td>
                </tr>
                <tr>
                    <td>
                        <label for="Email">Email:</label>
                        <input type="text" placeholder="JohnVogel@email.com">
                    </td>
                </tr>
            </table>
        </div>

        <div>
            <table>
                <tr>
                    <td>
                        <h4>Details</h4>
                        <p></p>
                    </td>
                </tr>
                <tr>
                    <td>
                        <label for="Tijdsduur">Tijdsduur in minuten: </label>
                        <input type="text" id="tijdsduurInput" placeholder="hh:mm">
                    </td>
                </tr>
                <tr>
                    <td>
                        <label for="Capaciteit">Max. Bezetting:</label>
                        <input type="text" id="capaciteitInput" placeholder="Max. Bezetting">
                    </td>
                </tr>
                <tr>
                    <td>
                        <label for="Categorie">Categorie:</label>
                        <input type="text" id="categorieInput" placeholder="Categorie">
                    </td>
                </tr>
            </table>
        </div>

        <div class="is-flex">
            <div id="benodigdhedenDiv">

            </div>
            <div id="geselecteerdeBenodigdhedenDiv">

            </div>
        </div>
        <div id="updateButton">

        </div>
      </div>
</body>
</html>